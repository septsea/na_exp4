我说几句话吧 (感受)。

这次就选相对简单的第一题。

这次我没用 Python 了, 主要是因为我的 Anaconda 崩坏了 (我的代码编辑器突然无法正常识别 Python 解释器, 而且提示、代码高亮等功能没了)。之后有空再修复它好了。想用别人的 PC 做一下作业, 但别人都是用 IDLE 写 Python (我觉得这就是个 "improved notepad")。

MATLAB 太庞大, 而且上学期的 MATLAB 课也没好好学。我这边打开 Octave Online 也很慢。

突然想起来, 上学期我跟风学了 Java。(我看很多学信算的都学了这个, 所以我也选了。选了之后才知道 "错" 有 13 画。差点没过。13 真是个不详数。)

我赶紧打开很久没打开过的 JDK 11, 用微软对 Java 支持最好的软件 Visual Studio Code 编写 Java 程序。我嫌 Eclipse 不好看, 嫌 Idea 太大 (而且还要 RMB, 要么就自己想办法破解)。

虽然现在科学计算多用像 Python, MATLAB, Maple, Mathematica 等工具, 不过 Java 还是能干一部分活的, 只是废话极多。(要是有 Interactive Java 就好了。) Apache 有一个大小约为 17 MB 的 jar 包, 里面的数学工具很齐全 (但是废话很多)。我先自己从零开始, 手写一个 Matrix 库。毕竟, 题干提到, 要自己写一部分程序。由于不想花太多时间, 我没有写矩阵四则运算 (在此处也用不到加减, 乘除可以用初等变换实现)。

基本的运算写完后, 就开始写 Gaussian elimination。由于它与 PLU 分解 (有的时候不一定能 LU 分解, 为了方便, 我写了 PLU 分解。非必须时这个算法不会进行行交换, 所以当输出结果显示 P 为单位矩阵时, 也就相当于 LU 分解了) 有密切关联, 我就写了一个约 100 行的方法同时进行 PLU 分解与 Gaussian elimination。

题干还提到用内置方法计算系数矩阵的逆与行列式, 这个时候, 前面说到的 Apache 的数学库就派上用场了。

我写的代码 (3 个文件合计 450 余行) 跟输出结果 (约 360 行) 都比较长, 所以我就把代码 (实则是整个 project) 放到 GitHub 与 Gitee 上了。

https://github.com/septsea/na_exp4

https://gitee.com/septsea/na_exp4

由于我不想把任务拖延到第二日, 我就没有详细给写文档了。不过, 由于 Java 是强类型的, 问题没有 Python 那么严重。

手打一遍代码后, 感受就是: 编程, 老工具人了 (拟人化)。虽然我不太可能靠编程吃饭, 但这东西能帮助我干很多活。

下面是输出结果。

Problem (1):

A =
3.01    6.03    1.99
1.27    4.16    -1.23
0.987   -4.81   9.34

b =
1.0
1.0
1.0

Row 0 <-> Row 1:
1.27    4.16    -1.23   1.0
3.01    6.03    1.9899999999999998      1.0
0.987   -4.81   9.34    1.0

1.27    4.16    -1.23   1.0
0.0     -3.8295275590551165     4.9051968503937005      -1.37007874015748
0.0     -8.043007874015748      10.295913385826772      0.22283464566929134

Row 1 <-> Row 2:
1.27    4.16    -1.23   1.0
-0.0    -8.043007874015748      10.295913385826772      0.22283464566929134
0.0     -3.8295275590551165     4.9051968503937005      -1.37007874015748

1.27    4.16    -1.23   1.0
-0.0    -8.043007874015748      10.295913385826772      0.22283464566929134
0.0     0.0     0.00299052730302396     -1.4761772831490547

1.27    4.16    0.0     -606.1498014538575
-0.0    -8.043007874015748      0.0     5082.46817447562
0.0     0.0     0.00299052730302396     -1.4761772831490547

1.27    0.0     0.0     2022.601523547914
-0.0    -8.043007874015748      0.0     5082.46817447562
0.0     0.0     0.00299052730302396     -1.4761772831490547

0.9999999999999999      0.0     0.0     1592.599624840877
0.0     1.0     -0.0    -631.911376202349
0.0     0.0     0.9999999999999999      -493.61772475923374

Solution:

1592.599624840877
-631.911376202349
-493.61772475923374

det A = -0.0305471000000146

====================================

A =
3.01    6.03    1.99
1.27    4.16    -1.23
0.987   -4.81   9.34

b =
1.0
1.0
1.0

A = PLU:

P =
1.0     0.0     0.0
0.0     1.0     0.0
0.0     0.0     1.0

L =
1.0     0.0     0.0
0.42192691029900337     1.0     0.0
0.32790697674418606     -4.200618895856894      1.0

U =
3.01    6.03    1.99
0.0     1.6157807308970096      -2.0696345514950165
0.0     0.0     -0.006280888249204253


Solve Pv = b:

v =
1.0
1.0
1.0

Solve Lw = v:

w =
1.0
0.5780730897009967
3.100357767040198

Solve Ux = w:

x =
1592.599624841384
-631.9113762025501
-493.6177247593909

det A = -0.030547100000004872

====================================

A =
10.0    -7.0    0.0     1.0
-3.0    2.099999        6.0     2.0
5.0     -1.0    5.0     -1.0
2.0     1.0     0.0     2.0

b =
8.0
5.900001
5.0
1.0

10.0    -7.0    0.0     1.0     8.0
0.0     -1.000000000139778E-6   6.0     2.3     8.300001
0.0     2.5     5.0     -1.5    1.0
0.0     2.4000000000000004      0.0     1.8     -0.6000000000000001

Row 1 <-> Row 2:
10.0    -7.0    0.0     1.0     8.0
-0.0    2.5     5.0     -1.5    1.0
0.0     -1.000000000139778E-6   6.0     2.3     8.300001
0.0     2.4000000000000004      0.0     1.8     -0.6000000000000001

10.0    -7.0    0.0     1.0     8.0
-0.0    2.5     5.0     -1.5    1.0
0.0     0.0     6.000002        2.2999994       8.3000014
0.0     0.0     -4.800000000000001      3.24    -1.5600000000000003

10.0    -7.0    0.0     1.0     8.0
-0.0    2.5     5.0     -1.5    1.0
0.0     0.0     6.000002        2.2999994       8.3000014
0.0     0.0     0.0     5.079998906667031       5.079998906667031

10.0    -7.0    0.0     0.0     7.0
0.0     2.5     5.0     0.0     2.5
0.0     0.0     6.000002        0.0     6.000001999999999
0.0     0.0     0.0     5.079998906667031       5.079998906667031

10.0    -7.0    0.0     0.0     7.0
0.0     2.5     0.0     0.0     -2.499999999999999
0.0     0.0     6.000002        0.0     6.000001999999999
0.0     0.0     0.0     5.079998906667031       5.079998906667031

10.0    0.0     0.0     0.0     2.6645352591003757E-15
0.0     2.5     0.0     0.0     -2.499999999999999
0.0     0.0     6.000002        0.0     6.000001999999999
0.0     0.0     0.0     5.079998906667031       5.079998906667031

1.0     0.0     0.0     0.0     2.664535259100376E-16
0.0     1.0     0.0     0.0     -0.9999999999999997
0.0     0.0     1.0     0.0     0.9999999999999999
0.0     0.0     0.0     1.0     1.0

Solution:

2.664535259100376E-16
-0.9999999999999997
0.9999999999999999
1.0

det A = -762.0000900000001

====================================

A =
10.0    -7.0    0.0     1.0
-3.0    2.099999        6.0     2.0
5.0     -1.0    5.0     -1.0
2.0     1.0     0.0     2.0

b =
8.0
5.900001
5.0
1.0

A = PLU:

P =
1.0     0.0     0.0     0.0
0.0     1.0     0.0     0.0
0.0     0.0     1.0     0.0
0.0     0.0     0.0     1.0

L =
1.0     0.0     0.0     0.0
-0.3    1.0     0.0     0.0
0.5     -2499999.999650555      1.0     0.0
0.2     -2399999.9996645334     0.9599996800001067      1.0

U =
10.0    -7.0    0.0     1.0
0.0     -1.000000000139778E-6   6.0     2.3
0.0     0.0     1.5000004997903332E7    5749998.499196276
0.0     0.0     0.0     5.079998907633126


Solve Pv = b:

v =
8.0
5.900001
5.0
1.0

Solve Lw = v:

w =
8.0
8.300001
2.075000349709961E7
5.079998906701803

Solve Ux = w:

x =
1.8333157214556198E-11
-1.0
1.0000000000702771
0.9999999998166686

det A = -762.0000901449143

Problem (2):

A =
3.0     6.03    1.99
1.27    4.16    -1.23
0.99    -4.81   9.34

b =
1.0
1.0
1.0

Row 0 <-> Row 1:
1.27    4.16    -1.23   1.0
3.0     6.03    1.9899999999999998      1.0
0.99    -4.81   9.34    1.0

1.27    4.16    -1.23   1.0
0.0     -3.796771653543307      4.8955118110236215      -1.3622047244094486
0.0     -8.052834645669291      10.298818897637794      0.22047244094488194

Row 1 <-> Row 2:
1.27    4.16    -1.23   1.0
-0.0    -8.052834645669291      10.298818897637794      0.22047244094488194
0.0     -3.796771653543307      4.8955118110236215      -1.3622047244094486

1.27    4.16    -1.23   1.0
-0.0    -8.052834645669291      10.298818897637794      0.22047244094488194
0.0     0.0     0.0397975965816304      -1.4661536505949877

1.27    4.16    0.0     -44.31351501422641
-0.0    -8.052834645669291      0.0     379.6315982514399
0.0     0.0     0.0397975965816304      -1.4661536505949877

1.27    0.0     0.0     151.79971941997366
-0.0    -8.052834645669291      0.0     379.6315982514399
0.0     0.0     0.0397975965816304      -1.4661536505949877

0.9999999999999999      0.0     0.0     119.5273381259635
0.0     1.0     -0.0    -47.142604431298096
0.0     0.0     1.0     -36.84025610912717

Solution:

119.5273381259635
-47.142604431298096
-36.84025610912717

det A = -0.40701399999999227

Problem (3):

A =
10.0    -7.0    0.0     1.0
-3.0    2.1     6.0     2.0
5.0     -1.0    5.0     -1.0
2.0     1.0     0.0     2.0

b =
8.0
5.900001
5.0
1.0

10.0    -7.0    0.0     1.0     8.0
0.0     0.0     6.0     2.3     8.300001
0.0     2.5     5.0     -1.5    1.0
0.0     2.4000000000000004      0.0     1.8     -0.6000000000000001

Row 1 <-> Row 2:
10.0    -7.0    0.0     1.0     8.0
-0.0    2.5     5.0     -1.5    1.0
0.0     0.0     6.0     2.3     8.300001
0.0     2.4000000000000004      0.0     1.8     -0.6000000000000001

10.0    -7.0    0.0     1.0     8.0
-0.0    2.5     5.0     -1.5    1.0
0.0     0.0     6.0     2.3     8.300001
0.0     0.0     -4.800000000000001      3.24    -1.5600000000000003

10.0    -7.0    0.0     1.0     8.0
-0.0    2.5     5.0     -1.5    1.0
0.0     0.0     6.0     2.3     8.300001
0.0     0.0     0.0     5.08    5.0800008000000005

10.0    -7.0    0.0     1.1102230246251565E-16  6.999999842519685
0.0     2.5     5.0     0.0     2.5000002362204725
0.0     0.0     6.0     0.0     6.000000637795275
0.0     0.0     0.0     5.08    5.0800008000000005

10.0    -7.0    0.0     1.1102230246251565E-16  6.999999842519685
0.0     2.5     0.0     0.0     -2.5000002952755906
0.0     0.0     6.0     0.0     6.000000637795275
0.0     0.0     0.0     5.08    5.0800008000000005

10.0    0.0     0.0     1.1102230246251565E-16  -9.842519679281736E-7
0.0     2.5     0.0     0.0     -2.5000002952755906
0.0     0.0     6.0     0.0     6.000000637795275
0.0     0.0     0.0     5.08    5.0800008000000005

1.0     0.0     0.0     1.1102230246251566E-17  -9.842519679281737E-8
0.0     1.0     0.0     0.0     -1.0000001181102363
0.0     0.0     1.0     0.0     1.0000001062992125
0.0     0.0     0.0     0.9999999999999999      1.000000157480315

Solution:

-9.842519679281737E-8
-1.0000001181102363
1.0000001062992125
1.000000157480315

det A = -762.0

Problem (4):

x1 = A1^(-1) * b1 =
Array2DRowRealMatrix{{1592.5996248414},{-631.9113762025},{-493.6177247594}}

x2 = A2^(-1) * b2 =
Array2DRowRealMatrix{{0.0},{-1.0},{1.0},{1.0}}

x3 = A3^(-1) * b3 =
Array2DRowRealMatrix{{119.527338126},{-47.1426044313},{-36.8402561091}}

x4 = A4^(-1) * b4 =
Array2DRowRealMatrix{{-0.0000000984},{-1.0000001181},{1.0000001063},{1.0000001575}}

det A1 = -0.030547100000004938
det A2 = -762.0000900000001
det A3 = -0.4070140000000067
det A4 = -762.0
